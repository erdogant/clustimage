<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>k-nearest neighbour &mdash; clustimage clustimage documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Performance" href="Performance.html" />
    <link rel="prev" title="Gridsearch" href="Cluster%20Evaluation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> clustimage
          </a>
              <div class="version">
                1.5.9
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Abstract.html">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="Abstract.html#schematic-overview">Schematic overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html#uninstalling">Uninstalling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core functionalities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="core_functions.html">Core functionalities</a></li>
<li class="toctree-l1"><a class="reference internal" href="core_functions.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="core_functions.html#output">Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="core_functions.html#generic-functionalities">Generic functionalities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Feature Extraction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Feature%20Extraction.html">PCA</a></li>
<li class="toctree-l1"><a class="reference internal" href="Feature%20Extraction.html#hog">HOG</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Cluster Evaluation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Cluster%20Evaluation.html">Gridsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cluster%20Evaluation.html#silhouette">Silhouette</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cluster%20Evaluation.html#dbindex">DBindex</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cluster%20Evaluation.html#dbscan">DBSCAN</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Find/Predict</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">k-nearest neighbour</a></li>
<li class="toctree-l1"><a class="reference internal" href="#probability-density-fitting">Probability density fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="#more-examples">More examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Performance</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Performance.html">Performance</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Save and Load</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Save%20and%20Load.html">Saving</a></li>
<li class="toctree-l1"><a class="reference internal" href="Save%20and%20Load.html#loading">Loading</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">Mnist dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html#caltech101-dataset">Caltech101 dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html#flower-dataset">Flower dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html#clustering-of-faces">Clustering of faces</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html#extract-images-belonging-to-clusters">Extract images belonging to clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html#set-image-filenames-using-pandas-dataframes">Set image filenames using pandas dataframes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html#import-images-from-url-location">Import images from url location</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html#breaking-up-the-steps">Breaking up the steps</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html">Sponsor</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#blog">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#github">Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#colab-notebook">Colab Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#citing">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Coding%20quality.html">Coding quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="clustimage.clustimage.html">API References</a></li>
</ul>

    <a href= "genindex.html">Index</a>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">clustimage</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>k-nearest neighbour</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Find.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>This section describes how to predict new unseen data points with a readily fitted model.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">find</span></code> function <a class="reference internal" href="clustimage.clustimage.html#clustimage.clustimage.Clustimage.find" title="clustimage.clustimage.Clustimage.find"><code class="xref py py-func docutils literal notranslate"><span class="pre">clustimage.clustimage.Clustimage.find()</span></code></a> allows to find images that are similar for what is readily being seen by the model. Finding images can be performed in two manners as described below. In both cases, the adjacency matrix is first computed using the distance metric (default Euclidean).</p>
<section id="k-nearest-neighbour">
<h1>k-nearest neighbour<a class="headerlink" href="#k-nearest-neighbour" title="Permalink to this headline"></a></h1>
<p>The k-nearest neighbour approach searches the k nearest neighbours to that of the input image using the (default) Euclidean distance metric. This approach dus not return a P-value the distances to the closest neighbors. If case both <em>k</em> and <em>alpha</em> are specified, the union of detected samples is taken.</p>
<p>Example to find similar samples for an unseen dataset using k-nearest neighbour approach.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">clustimage</span> <span class="kn">import</span> <span class="n">Clustimage</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Init with default settings</span>
<span class="n">cl</span> <span class="o">=</span> <span class="n">Clustimage</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pca&#39;</span><span class="p">)</span>
<span class="c1"># load example with digits</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">import_example</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;mnist&#39;</span><span class="p">)</span>

<span class="c1"># Make 1st subset</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">25</span><span class="p">))</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">idx</span><span class="p">),</span> <span class="p">:]</span>

<span class="c1"># Cluster dataset X</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># Results are also stored in object results</span>
<span class="n">cl</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="c1"># Scatter results</span>
<span class="n">cl</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dotsize</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Find images for 1st subset of images</span>
<span class="n">X1_results</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="c1"># Make scatter</span>
<span class="n">cl</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">zoom</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dotsize</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>

<span class="c1"># Print first key</span>
<span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">X1_results</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X1_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="c1"># [&#39;y_idx&#39;, &#39;distance&#39;, &#39;y_proba&#39;, &#39;labels&#39;, &#39;y_filenames&#39;, &#39;y_pathnames&#39;, &#39;x_pathnames&#39;]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X1_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])[[</span><span class="s1">&#39;labels&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">,</span><span class="s1">&#39;y_proba&#39;</span><span class="p">]])</span>
<span class="c1">#    labels    distance  y_proba</span>
<span class="c1"># 0       9  189.436546      NaN</span>
<span class="c1"># 1       9  305.387050      NaN</span>
<span class="c1"># 2       9  338.403554      NaN</span>
<span class="c1"># 3       9  342.050496      NaN</span>
<span class="c1"># 4       9  351.139465      NaN</span>

<span class="c1"># Get most often seen class label for key</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
    <span class="n">uiy</span><span class="p">,</span> <span class="n">ycounts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">X1_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)[</span><span class="s1">&#39;labels&#39;</span><span class="p">],</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">y_predict</span> <span class="o">=</span> <span class="n">uiy</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">ycounts</span><span class="p">)]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;class:[</span><span class="si">%s</span><span class="s1">] - </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">y_predict</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>

<span class="c1"># class:[9] - b2ea44d9-de55-421b-8bd1-6d13509533f5.png</span>
<span class="c1"># class:[4] - 60dabaf0-7e1a-4c57-bb57-5d464fd2d8fb.png</span>
<span class="c1"># class:[6] - dbc30522-5c83-4563-9c9f-40a86f24a091.png</span>
<span class="c1"># class:[1] - deb11282-a992-4282-8212-ba62ef1e26fc.png</span>
<span class="c1"># class:[3] - 29104a7c-775b-462f-84ba-e824c7c4b9c7.png</span>
<span class="c1"># class:[9] - 45e6f5fd-4423-4743-850e-921914bfb9c9.png</span>
<span class="c1"># class:[9] - 300a866e-5440-444a-b284-d2bfb1b1178b.png</span>
<span class="c1"># class:[8] - 2dd0defc-d72a-4189-abae-bd33a94ee044.png</span>
<span class="c1"># class:[7] - a308d13e-fa3e-4428-8b5e-edb26554d723.png</span>
<span class="c1"># class:[2] - 6dc9c2b5-e1eb-4b6e-891a-db657c663013.png</span>
<span class="c1"># class:[9] - 30477a7a-e7a0-44f2-8bb2-222719ebe12b.png</span>
<span class="c1"># class:[5] - 50261737-f812-4665-b46f-cf8afb3cc88c.png</span>
<span class="c1"># class:[0] - c83ab55a-2983-44a6-9e2e-4964dc13c1b0.png</span>
<span class="c1"># class:[9] - 3eafd007-b6ed-4d17-a9db-3477854525df.png</span>
<span class="c1"># class:[8] - 411c207e-4804-4e30-a1c5-546876e36c51.png</span>
<span class="c1"># class:[4] - 661ac0f2-6f41-493a-bb3a-2c068c632d86.png</span>
<span class="c1"># class:[9] - 9fc65ef1-ff93-4ac6-9cdb-f4605ee9661a.png</span>
<span class="c1"># class:[7] - 6d9e017e-fc6a-424f-8f40-52995db771dc.png</span>
<span class="c1"># class:[4] - dfc5cf51-2157-437f-b1ce-920100b74119.png</span>
<span class="c1"># class:[4] - 507c365d-d35d-4623-985a-e9512c511d11.png</span>
<span class="c1"># class:[0] - 058f3759-2608-490e-ac79-e5fde8d10f7e.png</span>
<span class="c1"># class:[2] - a10dbae8-81f1-4613-8fd9-0bfa4815f1ad.png</span>
<span class="c1"># class:[2] - a889af11-961c-42f6-8b34-3d0f7050c34c.png</span>
<span class="c1"># class:[0] - 2e92d26c-3bf4-4c25-9d7e-4ceaa2e06d69.png</span>
<span class="c1"># class:[4] - b7706e78-c653-4e26-9d7a-bcb512751526.png</span>
</pre></div>
</div>
</section>
<section id="probability-density-fitting">
<h1>Probability density fitting<a class="headerlink" href="#probability-density-fitting" title="Permalink to this headline"></a></h1>
<p>The probability density fitting method fits a model on the input features to determine the loc/scale/arg parameters across various theoretical distribution. In case of PCA, these are the principal components. The tested disributions are <em>[‘norm’, ‘expon’, ‘uniform’, ‘gamma’, ‘t’]</em>. The fitted distribution is the similarity-distribution of samples.</p>
<p>For each new (unseen) input image, the probability of similarity is computed across the images, and images with P &lt;= <a href="#id1"><span class="problematic" id="id2">*</span></a>alpha*(lower bound) are returned. Note that the metric can be changed in this function but this may lead to confusions as the results will not intuitively match with the scatter plots as these are determined using metric in the fit_transform() function.</p>
<p>Example to find similar samples for an unseen dataset using probability density fitting.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">clustimage</span> <span class="kn">import</span> <span class="n">Clustimage</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Init with default settings</span>
<span class="n">cl</span> <span class="o">=</span> <span class="n">Clustimage</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pca&#39;</span><span class="p">)</span>
<span class="c1"># load example with digits</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">import_example</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;mnist&#39;</span><span class="p">)</span>

<span class="c1"># Make 1st subset</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">25</span><span class="p">))</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">idx</span><span class="p">),</span> <span class="p">:]</span>

<span class="c1"># Cluster dataset X</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># Results are also stored in object results</span>
<span class="n">cl</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="c1"># Scatter results</span>
<span class="n">cl</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dotsize</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Find images for 1st subset of images</span>
<span class="n">X1_results</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="c1"># Make scatter</span>
<span class="n">cl</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">zoom</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dotsize</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>

<span class="c1"># Print first key</span>
<span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">X1_results</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X1_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="c1"># [&#39;y_idx&#39;, &#39;distance&#39;, &#39;y_proba&#39;, &#39;labels&#39;, &#39;y_filenames&#39;, &#39;y_pathnames&#39;, &#39;x_pathnames&#39;]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X1_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])[[</span><span class="s1">&#39;labels&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">,</span><span class="s1">&#39;y_proba&#39;</span><span class="p">]])</span>

<span class="c1">#     labels    distance   y_proba</span>
<span class="c1"># 0        8  189.373756  0.000035</span>
<span class="c1"># 1        8  305.290164  0.000822</span>
<span class="c1"># 2        8  338.588849  0.001812</span>
<span class="c1"># 3        8  341.933366  0.001956</span>
<span class="c1"># 4        8  351.231864  0.002412</span>
<span class="c1"># ..     ...         ...       ...</span>
<span class="c1"># 57       8  506.617886  0.044141</span>
<span class="c1"># 58       8  507.522983  0.044750</span>
<span class="c1"># 59       8  508.852247  0.045657</span>
<span class="c1"># 60       8  509.517201  0.046116</span>
<span class="c1"># 61       8  511.862011  0.047765</span>

<span class="c1"># Get most often seen class label for key</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
    <span class="n">uiy</span><span class="p">,</span> <span class="n">ycounts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">X1_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)[</span><span class="s1">&#39;labels&#39;</span><span class="p">],</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">y_predict</span> <span class="o">=</span> <span class="n">uiy</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">ycounts</span><span class="p">)]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;class:[</span><span class="si">%s</span><span class="s1">] - </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">y_predict</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>

<span class="c1"># class:[9] - b2ea44d9-de55-421b-8bd1-6d13509533f5.png</span>
<span class="c1"># class:[4] - 60dabaf0-7e1a-4c57-bb57-5d464fd2d8fb.png</span>
<span class="c1"># class:[6] - dbc30522-5c83-4563-9c9f-40a86f24a091.png</span>
<span class="c1"># class:[1] - deb11282-a992-4282-8212-ba62ef1e26fc.png</span>
<span class="c1"># class:[3] - 29104a7c-775b-462f-84ba-e824c7c4b9c7.png</span>
<span class="c1"># class:[9] - 45e6f5fd-4423-4743-850e-921914bfb9c9.png</span>
<span class="c1"># class:[9] - 300a866e-5440-444a-b284-d2bfb1b1178b.png</span>
<span class="c1"># class:[8] - 2dd0defc-d72a-4189-abae-bd33a94ee044.png</span>
<span class="c1"># class:[7] - a308d13e-fa3e-4428-8b5e-edb26554d723.png</span>
<span class="c1"># class:[2] - 6dc9c2b5-e1eb-4b6e-891a-db657c663013.png</span>
<span class="c1"># class:[9] - 30477a7a-e7a0-44f2-8bb2-222719ebe12b.png</span>
<span class="c1"># class:[5] - 50261737-f812-4665-b46f-cf8afb3cc88c.png</span>
<span class="c1"># class:[0] - c83ab55a-2983-44a6-9e2e-4964dc13c1b0.png</span>
<span class="c1"># class:[9] - 3eafd007-b6ed-4d17-a9db-3477854525df.png</span>
<span class="c1"># class:[8] - 411c207e-4804-4e30-a1c5-546876e36c51.png</span>
<span class="c1"># class:[4] - 661ac0f2-6f41-493a-bb3a-2c068c632d86.png</span>
<span class="c1"># class:[9] - 9fc65ef1-ff93-4ac6-9cdb-f4605ee9661a.png</span>
<span class="c1"># class:[7] - 6d9e017e-fc6a-424f-8f40-52995db771dc.png</span>
<span class="c1"># class:[4] - dfc5cf51-2157-437f-b1ce-920100b74119.png</span>
<span class="c1"># class:[4] - 507c365d-d35d-4623-985a-e9512c511d11.png</span>
<span class="c1"># class:[0] - 058f3759-2608-490e-ac79-e5fde8d10f7e.png</span>
<span class="c1"># class:[2] - a10dbae8-81f1-4613-8fd9-0bfa4815f1ad.png</span>
<span class="c1"># class:[2] - a889af11-961c-42f6-8b34-3d0f7050c34c.png</span>
<span class="c1"># class:[0] - 2e92d26c-3bf4-4c25-9d7e-4ceaa2e06d69.png</span>
<span class="c1"># class:[4] - b7706e78-c653-4e26-9d7a-bcb512751526.png</span>
</pre></div>
</div>
</section>
<section id="more-examples">
<h1>More examples<a class="headerlink" href="#more-examples" title="Permalink to this headline"></a></h1>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">clustimage</span> <span class="kn">import</span> <span class="n">Clustimage</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Init with default settings</span>
<span class="n">cl</span> <span class="o">=</span> <span class="n">Clustimage</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pca&#39;</span><span class="p">)</span>

<span class="c1"># load example with digits</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">import_example</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;mnist&#39;</span><span class="p">)</span>

<span class="c1"># Cluster digits</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Lets search for the following image:</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;dim&#39;</span><span class="p">]),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>

<span class="c1"># Find images</span>
<span class="n">results_find</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,:],</span> <span class="n">k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="c1"># Show whatever is found. This looks pretty good.</span>
<span class="n">cl</span><span class="o">.</span><span class="n">plot_find</span><span class="p">()</span>
<span class="n">cl</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Extract the first input image name</span>
<span class="n">filename</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">results_find</span><span class="o">.</span><span class="n">keys</span><span class="p">()][</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Plot the probabilities</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">results_find</span><span class="p">[</span><span class="n">filename</span><span class="p">][</span><span class="s1">&#39;y_proba&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;samples&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pvalue&#39;</span><span class="p">)</span>

<span class="c1"># Extract the cluster labels for the input image</span>
<span class="n">results_find</span><span class="p">[</span><span class="n">filename</span><span class="p">][</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span>

<span class="c1"># The majority of labels is for class 0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">results_find</span><span class="p">[</span><span class="n">filename</span><span class="p">][</span><span class="s1">&#39;labels&#39;</span><span class="p">]))</span>
<span class="c1"># 0    171</span>
<span class="c1"># 7      8</span>
<span class="c1"># Name: labels, dtype: int64</span>
</pre></div>
</div>
<table class="docutils align-center" id="id3">
<caption><span class="caption-text">Find results for digits.</span><a class="headerlink" href="#id3" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><img alt="figCF1" src="_images/find_digit.png" /></p></td>
<td><p><img alt="figCF2" src="_images/find_in_pca.png" /></p></td>
</tr>
<tr class="row-even"><td><p><img alt="figCF3" src="_images/find_proba.png" /></p></td>
<td><p><img alt="figCF4" src="_images/find_results.png" /></p></td>
</tr>
</tbody>
</table>
<p>** Example to find similar images based on the pathname as input.**</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">clustimage</span> <span class="kn">import</span> <span class="n">Clustimage</span>

<span class="c1"># Init with default settings</span>
<span class="n">cl</span> <span class="o">=</span> <span class="n">Clustimage</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pca&#39;</span><span class="p">)</span>

<span class="c1"># load example with flowers</span>
<span class="n">pathnames</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">import_example</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;flowers&#39;</span><span class="p">)</span>

<span class="c1"># Cluster flowers</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">pathnames</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

<span class="c1"># Lets search for the following image:</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">pathnames</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">colorscale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">3</span><span class="p">)));</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="c1"># Find images</span>
<span class="n">results_find</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">pathnames</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="c1"># Show whatever is found. This looks pretty good.</span>
<span class="n">cl</span><span class="o">.</span><span class="n">plot_find</span><span class="p">()</span>
<span class="n">cl</span><span class="o">.</span><span class="n">scatter</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils align-center" id="id4">
<caption><span class="caption-text">Find results for the flower using pathname as input.</span><a class="headerlink" href="#id4" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><img alt="figCF5" src="_images/find_flowers.png" /></p></td>
<td><p><img alt="figCF6" src="_images/find_flowers_scatter.png" /></p></td>
</tr>
</tbody>
</table>
<hr>
<center>
        <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CEADP27U&placement=erdogantgithubio" id="_carbonads_js"></script>
</center>
<hr></section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Cluster%20Evaluation.html" class="btn btn-neutral float-left" title="Gridsearch" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Performance.html" class="btn btn-neutral float-right" title="Performance" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Erdogan Taskesen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>